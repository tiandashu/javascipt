<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>闭包</title>
</head>
<body>
    
</body>
</html>
<script>
    // 闭包
    // 闭包是一个受到保护的变量空间，由内嵌函数生成。
    // javascript是具有函数级的作用域，在函数内部定义的变量在函数的外部是无法直接访问到的
    // javascript的作用域又是词法性质的，意味着函数运行在定义它的作用域而不是调用它的作用域
    // 两者结合起来就能创建一个匿名函数包裹的私有变量。

    // 执行环境
    // 执行环境定义了变量或者函数有权访问的其它数据，每个执行文件都有一个与之相关联的变量对象，执行环境中定义的变量和函数就存在这个变量中
    // 全局执行环境是最外围的一个执行环境，通常认为是window对象
    // 执行环境和变量对象在运行函数时生成
    // 执行环境中的所有代码执行完以后，执行环境被销毁，保存在其中的变量和函数也随之销毁(全局执行环境到应用退出时销毁)

    // 作用域链
    // 当代码在一个执行环境中执行时，会创建变量对象的一个作用域链(scope chain)，作用域链用来指定执行环境有权访问的所有变量和函数的访问顺序
    // 作用域链的最前端，始终是当前代码执行环境的变量对象，如果这个环境是函数，则其活动对象就是变量对象
    // 作用域链的下一个变量对象，来自外部包含环境，再下一个变量对象，来自下一个外部包含环境，以此类推直到全局执行环境
    // 在函数执行过程，根据当前执行环境的作用域链来逐层向外查找变量，并且进行标识符解析


    var a = 'a';
    function outer() {
        var a = 0;
        return function inner() {
            console.log(a++)
        }
    }

    var s = outer(); // 执行环境在函数运行的时候生成，执行环境中所有的代码执行完以后执行环境销毁，保存在其中的变量和函数也随之销毁
    s(); //0
    s(); //1

    var s = outer; //outer每执行一次就生成一次执行环境
    s()(); //0  形成执行环境outer
    s()(); //0  形成执行环境outer
</script>